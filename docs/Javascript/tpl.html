<!DOCTYPE html>

<html>
<head>
  <title>tpl.js</title>
  <meta http-equiv="content-type" content="text/html; charset=UTF-8">
  <meta name="viewport" content="width=device-width, target-densitydpi=160dpi, initial-scale=1.0; maximum-scale=1.0; user-scalable=0;">
  <link rel="stylesheet" media="all" href="docco.css" />
</head>
<body>
  <div id="container">
    <div id="background"></div>
    
      <ul id="jump_to">
        <li>
          <a class="large" href="javascript:void(0);">Jump To &hellip;</a>
          <a class="small" href="javascript:void(0);">+</a>
          <div id="jump_wrapper">
          <div id="jump_page">
            
              
              <a class="source" href="SpecRunner.html">
                SpecRunner.js
              </a>
            
              
              <a class="source" href="app.html">
                app.js
              </a>
            
              
              <a class="source" href="dialog.html">
                dialog.js
              </a>
            
              
              <a class="source" href="modal.html">
                modal.js
              </a>
            
              
              <a class="source" href="revealoptions.html">
                revealoptions.js
              </a>
            
              
              <a class="source" href="localstorage.html">
                localstorage.js
              </a>
            
              
              <a class="source" href="alert_controller.html">
                alert_controller.js
              </a>
            
              
              <a class="source" href="alert_view.html">
                alert_view.js
              </a>
            
              
              <a class="source" href="edit_controller.html">
                edit_controller.js
              </a>
            
              
              <a class="source" href="edit_view.html">
                edit_view.js
              </a>
            
              
              <a class="source" href="episodes_app.html">
                episodes_app.js
              </a>
            
              
              <a class="source" href="feed_controller.html">
                feed_controller.js
              </a>
            
              
              <a class="source" href="feed_view.html">
                feed_view.js
              </a>
            
              
              <a class="source" href="list_controller.html">
                list_controller.js
              </a>
            
              
              <a class="source" href="list_view.html">
                list_view.js
              </a>
            
              
              <a class="source" href="nav_controller.html">
                nav_controller.js
              </a>
            
              
              <a class="source" href="nav_view.html">
                nav_view.js
              </a>
            
              
              <a class="source" href="new_view.html">
                new_view.js
              </a>
            
              
              <a class="source" href="player_controller.html">
                player_controller.js
              </a>
            
              
              <a class="source" href="player_view.html">
                player_view.js
              </a>
            
              
              <a class="source" href="playlist_controller.html">
                playlist_controller.js
              </a>
            
              
              <a class="source" href="playlist_view.html">
                playlist_view.js
              </a>
            
              
              <a class="source" href="show_controller.html">
                show_controller.js
              </a>
            
              
              <a class="source" href="show_view.html">
                show_view.js
              </a>
            
              
              <a class="source" href="FeedSpec.html">
                FeedSpec.js
              </a>
            
              
              <a class="source" href="async.html">
                async.js
              </a>
            
              
              <a class="source" href="list_controller.html">
                list_controller.js
              </a>
            
              
              <a class="source" href="list_view.html">
                list_view.js
              </a>
            
              
              <a class="source" href="show_controller.html">
                show_controller.js
              </a>
            
              
              <a class="source" href="show_view.html">
                show_view.js
              </a>
            
              
              <a class="source" href="subscriptions_app.html">
                subscriptions_app.js
              </a>
            
              
              <a class="source" href="build.html">
                build.js
              </a>
            
              
              <a class="source" href="modal.html">
                modal.js
              </a>
            
              
              <a class="source" href="utils.html">
                utils.js
              </a>
            
              
              <a class="source" href="view.html">
                view.js
              </a>
            
              
              <a class="source" href="views.html">
                views.js
              </a>
            
              
              <a class="source" href="episode.html">
                episode.js
              </a>
            
              
              <a class="source" href="feed.html">
                feed.js
              </a>
            
              
              <a class="source" href="player.html">
                player.js
              </a>
            
              
              <a class="source" href="playlist.html">
                playlist.js
              </a>
            
              
              <a class="source" href="subscriptions.html">
                subscriptions.js
              </a>
            
              
              <a class="source" href="topics.html">
                topics.js
              </a>
            
              
              <a class="source" href="require_main.html">
                require_main.js
              </a>
            
              
              <a class="source" href="require_main_built.html">
                require_main_built.js
              </a>
            
              
              <a class="source" href="almond.html">
                almond.js
              </a>
            
              
              <a class="source" href="backbone.babysitter.html">
                backbone.babysitter.js
              </a>
            
              
              <a class="source" href="backbone.html">
                backbone.js
              </a>
            
              
              <a class="source" href="backbone.localstorage.html">
                backbone.localstorage.js
              </a>
            
              
              <a class="source" href="backbone.localstorage.min.html">
                backbone.localstorage.min.js
              </a>
            
              
              <a class="source" href="backbone.marionette.html">
                backbone.marionette.js
              </a>
            
              
              <a class="source" href="backbone.marionette.min.html">
                backbone.marionette.min.js
              </a>
            
              
              <a class="source" href="backbone.picky.html">
                backbone.picky.js
              </a>
            
              
              <a class="source" href="backbone.syphon.html">
                backbone.syphon.js
              </a>
            
              
              <a class="source" href="backbone.wreqr.html">
                backbone.wreqr.js
              </a>
            
              
              <a class="source" href="foundation.fastclick.html">
                foundation.fastclick.js
              </a>
            
              
              <a class="source" href="foundation.html">
                foundation.js
              </a>
            
              
              <a class="source" href="foundation.min.html">
                foundation.min.js
              </a>
            
              
              <a class="source" href="foundation.offcanvas.html">
                foundation.offcanvas.js
              </a>
            
              
              <a class="source" href="foundation.reveal.html">
                foundation.reveal.js
              </a>
            
              
              <a class="source" href="jasmine-html.html">
                jasmine-html.js
              </a>
            
              
              <a class="source" href="jasmine.html">
                jasmine.js
              </a>
            
              
              <a class="source" href="jasmine-html.html">
                jasmine-html.js
              </a>
            
              
              <a class="source" href="jasmine.html">
                jasmine.js
              </a>
            
              
              <a class="source" href="jquery-ui-1.10.3.min.html">
                jquery-ui-1.10.3.min.js
              </a>
            
              
              <a class="source" href="jquery-ui.html">
                jquery-ui.js
              </a>
            
              
              <a class="source" href="jquery.html">
                jquery.js
              </a>
            
              
              <a class="source" href="jquery.transit.html">
                jquery.transit.js
              </a>
            
              
              <a class="source" href="jquery.transmit.html">
                jquery.transmit.js
              </a>
            
              
              <a class="source" href="json2.html">
                json2.js
              </a>
            
              
              <a class="source" href="log.html">
                log.js
              </a>
            
              
              <a class="source" href="modernizr.html">
                modernizr.js
              </a>
            
              
              <a class="source" href="require.html">
                require.js
              </a>
            
              
              <a class="source" href="jasmine-sinon.html">
                jasmine-sinon.js
              </a>
            
              
              <a class="source" href="sinon.html">
                sinon.js
              </a>
            
              
              <a class="source" href="spin.jquery.html">
                spin.jquery.js
              </a>
            
              
              <a class="source" href="spin.html">
                spin.js
              </a>
            
              
              <a class="source" href="tpl.html">
                tpl.js
              </a>
            
              
              <a class="source" href="underscore.html">
                underscore.js
              </a>
            
          </div>
        </li>
      </ul>
    
    <ul class="sections">
        
          <li id="title">
              <div class="annotation">
                  <h1>tpl.js</h1>
              </div>
          </li>
        
        
        
        <li id="section-1">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-1">&#182;</a>
              </div>
              
            </div>
            
            <div class="content"><div class='highlight'><pre><span class="hljs-comment">/**
 * Adapted from the official plugin text.js
 *
 * Uses UnderscoreJS micro-templates : http://documentcloud.github.com/underscore/#template
 * @author Julien Cabanès &lt;julien@zeeagency.com&gt;
 * @version 0.2
 *
 * @license RequireJS text 0.24.0 Copyright (c) 2010-2011, The Dojo Foundation All Rights Reserved.
 * Available via the MIT or new BSD license.
 * see: http://github.com/jrburke/requirejs for details
 */</span>
<span class="hljs-comment">/*jslint regexp: false, nomen: false, plusplus: false, strict: false */</span>
<span class="hljs-comment">/*global require: false, XMLHttpRequest: false, ActiveXObject: false,
  define: false, window: false, process: false, Packages: false,
  java: false */</span>

(<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">()</span> {</span></pre></div></div>
            
        </li>
        
        
        <li id="section-2">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-2">&#182;</a>
              </div>
              <blockquote>
<blockquote>
<p>excludeStart(‘excludeTpl’, pragmas.excludeTpl)</p>
</blockquote>
</blockquote>

            </div>
            
            <div class="content"><div class='highlight'><pre>	<span class="hljs-keyword">var</span> progIds = [<span class="hljs-string">'Msxml2.XMLHTTP'</span>, <span class="hljs-string">'Microsoft.XMLHTTP'</span>, <span class="hljs-string">'Msxml2.XMLHTTP.4.0'</span>],

		xmlRegExp = <span class="hljs-regexp">/^\s*&lt;\?xml(\s)+version=[\'\"](\d)*.(\d)*[\'\"](\s)*\?&gt;/im</span>,

		bodyRegExp = <span class="hljs-regexp">/&lt;body[^&gt;]*&gt;\s*([\s\S]+)\s*&lt;\/body&gt;/im</span>,

		buildMap = [],

		templateSettings = {
			evaluate	: <span class="hljs-regexp">/&lt;%([\s\S]+?)%&gt;/g</span>,
			interpolate : <span class="hljs-regexp">/&lt;%=([\s\S]+?)%&gt;/g</span>
		},

		<span class="hljs-comment">/**
		 * JavaScript micro-templating, similar to John Resig's implementation.
		 * Underscore templating handles arbitrary delimiters, preserves whitespace,
		 * and correctly escapes quotes within interpolated code.
		 */</span>
		template = <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(str, data)</span> {</span>
			<span class="hljs-keyword">var</span> c  = templateSettings;
			<span class="hljs-keyword">var</span> tmpl = <span class="hljs-string">'var __p=[],print=function(){__p.push.apply(__p,arguments);};'</span> +
				<span class="hljs-string">'with(obj||{}){__p.push(\''</span> +
				str.replace(<span class="hljs-regexp">/\\/g</span>, <span class="hljs-string">'\\\\'</span>)
					.replace(<span class="hljs-regexp">/'/g</span>, <span class="hljs-string">"\\'"</span>)
					.replace(c.interpolate, <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(match, code)</span> {</span>
					<span class="hljs-keyword">return</span> <span class="hljs-string">"',"</span> + code.replace(<span class="hljs-regexp">/\\'/g</span>, <span class="hljs-string">"'"</span>) + <span class="hljs-string">",'"</span>;
					})
					.replace(c.evaluate || <span class="hljs-literal">null</span>, <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(match, code)</span> {</span>
					<span class="hljs-keyword">return</span> <span class="hljs-string">"');"</span> + code.replace(<span class="hljs-regexp">/\\'/g</span>, <span class="hljs-string">"'"</span>)
										.replace(<span class="hljs-regexp">/[\r\n\t]/g</span>, <span class="hljs-string">' '</span>) + <span class="hljs-string">"; __p.push('"</span>;
					})
					.replace(<span class="hljs-regexp">/\r/g</span>, <span class="hljs-string">''</span>)
					.replace(<span class="hljs-regexp">/\n/g</span>, <span class="hljs-string">''</span>)
					.replace(<span class="hljs-regexp">/\t/g</span>, <span class="hljs-string">''</span>)
					+ <span class="hljs-string">"');}return __p.join('');"</span>;
			<span class="hljs-keyword">return</span> tmpl;

			<span class="hljs-comment">/** /
			var func = new Function('obj', tmpl);
			return data ? func(data) : func;
			/**/</span>
		};</pre></div></div>
            
        </li>
        
        
        <li id="section-3">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-3">&#182;</a>
              </div>
              <blockquote>
<blockquote>
<p>excludeEnd(‘excludeTpl’)</p>
</blockquote>
</blockquote>

            </div>
            
            <div class="content"><div class='highlight'><pre>
	define(<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">()</span> {</span></pre></div></div>
            
        </li>
        
        
        <li id="section-4">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-4">&#182;</a>
              </div>
              <blockquote>
<blockquote>
<p>excludeStart(‘excludeTpl’, pragmas.excludeTpl)</p>
</blockquote>
</blockquote>

            </div>
            
            <div class="content"><div class='highlight'><pre>		<span class="hljs-keyword">var</span> tpl;

		<span class="hljs-keyword">var</span> get, fs;
		<span class="hljs-keyword">if</span> (<span class="hljs-keyword">typeof</span> window !== <span class="hljs-string">"undefined"</span> &amp;&amp; window.navigator &amp;&amp; window.document) {
			get = <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">(url, callback)</span> {</span>

				<span class="hljs-keyword">var</span> xhr = tpl.createXhr();
				xhr.open(<span class="hljs-string">'GET'</span>, url, <span class="hljs-literal">true</span>);
				xhr.onreadystatechange = <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">(evt)</span> {</span></pre></div></div>
            
        </li>
        
        
        <li id="section-5">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-5">&#182;</a>
              </div>
              <p>Do not explicitly handle errors, those should be
visible via console output in the browser.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>					<span class="hljs-keyword">if</span> (xhr.readyState === <span class="hljs-number">4</span>) {
						callback(xhr.responseText);
					}
				};
				xhr.send(<span class="hljs-literal">null</span>);
			};
		} <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (<span class="hljs-keyword">typeof</span> process !== <span class="hljs-string">"undefined"</span> &amp;&amp;
 				process.versions &amp;&amp;
 				!!process.versions.node) {</pre></div></div>
            
        </li>
        
        
        <li id="section-6">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-6">&#182;</a>
              </div>
              <p>Using special require.nodeRequire, something added by r.js.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>			fs = <span class="hljs-built_in">require</span>.nodeRequire(<span class="hljs-string">'fs'</span>);

			get = <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">(url, callback)</span> {</span>

				callback(fs.readFileSync(url, <span class="hljs-string">'utf8'</span>));
			};
		}
		<span class="hljs-keyword">return</span> tpl = {
			version: <span class="hljs-string">'0.24.0'</span>,
			strip: <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">(content)</span> {</span></pre></div></div>
            
        </li>
        
        
        <li id="section-7">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-7">&#182;</a>
              </div>
              <p>Strips &lt;?xml …?&gt; declarations so that external SVG and XML
documents can be added to a document without worry. Also, if the string
is an HTML document, only the part inside the body tag is returned.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>				<span class="hljs-keyword">if</span> (content) {
					content = content.replace(xmlRegExp, <span class="hljs-string">""</span>);
					<span class="hljs-keyword">var</span> matches = content.match(bodyRegExp);
					<span class="hljs-keyword">if</span> (matches) {
						content = matches[<span class="hljs-number">1</span>];
					}
				} <span class="hljs-keyword">else</span> {
					content = <span class="hljs-string">""</span>;
				}

				<span class="hljs-keyword">return</span> content;
			},

			jsEscape: <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">(content)</span> {</span>
				<span class="hljs-keyword">return</span> content.replace(<span class="hljs-regexp">/(['\\])/g</span>, <span class="hljs-string">'\\$1'</span>)
					.replace(<span class="hljs-regexp">/[\f]/g</span>, <span class="hljs-string">"\\f"</span>)
					.replace(<span class="hljs-regexp">/[\b]/g</span>, <span class="hljs-string">"\\b"</span>)
					.replace(<span class="hljs-regexp">/[\n]/g</span>, <span class="hljs-string">""</span>)
					.replace(<span class="hljs-regexp">/[\t]/g</span>, <span class="hljs-string">""</span>)
					.replace(<span class="hljs-regexp">/[\r]/g</span>, <span class="hljs-string">""</span>);
			},

			createXhr: <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">()</span> {</span></pre></div></div>
            
        </li>
        
        
        <li id="section-8">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-8">&#182;</a>
              </div>
              <p>Would love to dump the ActiveX crap in here. Need IE 6 to die first.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>				<span class="hljs-keyword">var</span> xhr, i, progId;
				<span class="hljs-keyword">if</span> (<span class="hljs-keyword">typeof</span> XMLHttpRequest !== <span class="hljs-string">"undefined"</span>) {
					<span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> XMLHttpRequest();
				} <span class="hljs-keyword">else</span> {
					<span class="hljs-keyword">for</span> (i = <span class="hljs-number">0</span>; i &lt; <span class="hljs-number">3</span>; i++) {
						progId = progIds[i];
						<span class="hljs-keyword">try</span> {
							xhr = <span class="hljs-keyword">new</span> ActiveXObject(progId);
						} <span class="hljs-keyword">catch</span> (e) {}

						<span class="hljs-keyword">if</span> (xhr) {
							progIds = [progId];  <span class="hljs-comment">// so faster next time</span>
							<span class="hljs-keyword">break</span>;
						}
					}
				}

				<span class="hljs-keyword">if</span> (!xhr) {
					<span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-built_in">Error</span>(<span class="hljs-string">"require.getXhr(): XMLHttpRequest not available"</span>);
				}

				<span class="hljs-keyword">return</span> xhr;
			},

			get: get,

			load: <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">(name, req, onLoad, config)</span> {</span></pre></div></div>
            
        </li>
        
        
        <li id="section-9">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-9">&#182;</a>
              </div>
              <p>Name has format: some.module.filext!strip
The strip part is optional.
if strip is present, then that means only get the string contents
inside a body tag in an HTML string. For XML/SVG content it means
removing the &lt;?xml …?&gt; declarations so the content can be inserted
into the current doc without problems.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>
				<span class="hljs-keyword">var</span> strip = <span class="hljs-literal">false</span>, url, index = name.indexOf(<span class="hljs-string">"."</span>),
					modName = name.substring(<span class="hljs-number">0</span>, index),
					ext = name.substring(index + <span class="hljs-number">1</span>, name.length);

				index = ext.indexOf(<span class="hljs-string">"!"</span>);

				<span class="hljs-keyword">if</span> (index !== -<span class="hljs-number">1</span>) {</pre></div></div>
            
        </li>
        
        
        <li id="section-10">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-10">&#182;</a>
              </div>
              <p>Pull off the strip arg.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>					strip = ext.substring(index + <span class="hljs-number">1</span>, ext.length);
					strip = strip === <span class="hljs-string">"strip"</span>;
					ext = ext.substring(<span class="hljs-number">0</span>, index);
				}</pre></div></div>
            
        </li>
        
        
        <li id="section-11">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-11">&#182;</a>
              </div>
              <p>Load the tpl.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>				url = <span class="hljs-string">'nameToUrl'</span> <span class="hljs-keyword">in</span> req ? req.nameToUrl(modName, <span class="hljs-string">"."</span> + ext) : req.toUrl(modName + <span class="hljs-string">"."</span> + ext);

				tpl.get(url, <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">(content)</span> {</span>
					content = template(content);

					<span class="hljs-keyword">if</span>(!config.isBuild) {</pre></div></div>
            
        </li>
        
        
        <li id="section-12">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-12">&#182;</a>
              </div>
              <p>if(typeof window !== “undefined” &amp;&amp; window.navigator &amp;&amp; window.document) {</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>						content = <span class="hljs-keyword">new</span> <span class="hljs-built_in">Function</span>(<span class="hljs-string">'obj'</span>, content);
					}
					content = strip ? tpl.strip(content) : content;

					<span class="hljs-keyword">if</span> (config.isBuild &amp;&amp; config.inlineText) {
						buildMap[name] = content;
					}
					onLoad(content);
				});

			},

			write: <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">(pluginName, moduleName, write)</span> {</span>
				<span class="hljs-keyword">if</span> (moduleName <span class="hljs-keyword">in</span> buildMap) {
					<span class="hljs-keyword">var</span> content = tpl.jsEscape(buildMap[moduleName]);
					write(<span class="hljs-string">"define('"</span> + pluginName + <span class="hljs-string">"!"</span> + moduleName  +
  						<span class="hljs-string">"', function() {return function(obj) { "</span> +
  							content.replace(<span class="hljs-regexp">/(\\')/g</span>, <span class="hljs-string">"'"</span>).replace(<span class="hljs-regexp">/(\\\\)/g</span>, <span class="hljs-string">"\\"</span>)+
  						<span class="hljs-string">"}});\n"</span>);
				}
			}
		};</pre></div></div>
            
        </li>
        
        
        <li id="section-13">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-13">&#182;</a>
              </div>
              <blockquote>
<blockquote>
<p>excludeEnd(‘excludeTpl’)</p>
</blockquote>
</blockquote>

            </div>
            
            <div class="content"><div class='highlight'><pre>		<span class="hljs-keyword">return</span> <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span> {</span>};
	});</pre></div></div>
            
        </li>
        
        
        <li id="section-14">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-14">&#182;</a>
              </div>
              <blockquote>
<blockquote>
<p>excludeEnd(‘excludeTpl’)</p>
</blockquote>
</blockquote>

            </div>
            
            <div class="content"><div class='highlight'><pre>}());</pre></div></div>
            
        </li>
        
    </ul>
  </div>
</body>
</html>
